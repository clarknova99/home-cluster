---
- name: Clone VMs
  hosts: nuc11
  become: true
  tasks:
    - name: Clone
      ansible.builtin.command: "qm clone 8000 {{ item.key1 }} --full true --storage local-lvm --name {{ item.key2 }}"
      with_items:
        - key1: "301"
          key2: "k3s-1"
        - key1: "302"
          key2: "k3s-2"
        - key1: "303"
          key2: "k3s-3"
        - key1: "304"
          key2: "k3s-4"
        - key1: "305"
          key2: "k3s-5"
    - name: Resize
      ansible.builtin.command: "qm resize {{ item.key1 }} scsi0 +5G"
      with_items:
        - key1: "301"
        - key1: "302"
        - key1: "303"
        - key1: "304"
        - key1: "305"
    - name: Network
      ansible.builtin.command: "qm set {{ item.key1 }} --ipconfig0 gw=192.168.1.1,ip={{ item.key2 }}/24"
      with_items:
        - key1: "301"
          key2: "192.168.1.31"
        - key1: "302"
          key2: "192.168.1.32"
        - key1: "303"
          key2: "192.168.1.33"
        - key1: "304"
          key2: "192.168.1.34"
        - key1: "305"
          key2: "192.168.1.35"
...
